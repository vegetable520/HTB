<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Miari</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Miari</h1><br/><p><img src="images/5-1.png" alt="images/5-1.png" /><h3></h3></p><p><h3>设备运行 PiHole 的 RaspberryPi，拥有默认用户名密码，很顺利就能拿到高权限shell，最后查看flag时需要从usb驱动器恢复已经删除的数据 </h3></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>	◇ <a href="Blocky_4.html#h1-1">nmap</a></p><p>	◇ <a href="Blocky_4.html#h1-2">TCP/32400</a></p><p>	◇ <a href="Blocky_4.html#h1-3">TCP/80</a></p><p>	◇ <a href="Blocky_4.html#h1-4">Shell as pi</a></p><p>	◇ <a href="Blocky_4.html#h1-5">Shell as root</a></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p><h1>nmap</h1><a name="h1-1"></a></p><p>一样的，还是先使用nmap扫描目标，获取目标端口开放情况</p><p><div class="codebox"><pre>nmap -sC -sV -p- -oA nmap 10.10.10.48<br /><br />PORT      STATE    SERVICE VERSION<br />22/tcp    open     ssh     OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA)<br />|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA)<br />|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA)<br />|_  256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519)<br />53/tcp    open     domain  dnsmasq 2.76<br />| dns-nsid: <br />|_  bind.version: dnsmasq-2.76<br />80/tcp    open     http    lighttpd 1.4.35<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />|_http-server-header: lighttpd/1.4.35<br />1101/tcp  open     upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br />11624/tcp filtered unknown<br />32036/tcp filtered unknown<br />32361/tcp filtered unknown<br />32400/tcp open     http    Plex Media Server httpd<br />|_http-title: Unauthorized<br />| http-auth: <br />| HTTP/1.1 401 Unauthorized\x0D<br />|_  Server returned status 401 but no WWW-Authenticate header.<br />|_http-favicon: Plex<br />|_http-cors: HEAD GET POST PUT DELETE OPTIONS<br />32469/tcp open     upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</pre></div></p><p><h1>TCP/32400</h1><a name="h1-2"></a></p><p>开启了很多端口，80和32400都运行着http服务，访问80端口没有数据，猜测还是因为无法进行域名解析，32400端口可以访问，可以看到是一个PLEX的后台登录表单，PLEX是一个媒体服务器，可在多平台运行，简单尝试弱口令没有效果，并且尝试多次会被禁用登录。</p><p><img src="images/5-2.png" alt="images/5-2.png" /></p><p>暂时没有发现其他的，尝试扫描目录也没有什么好的发现，因此先尝试扫描一下80端口的目录</p><p><div class="codebox"><pre>gobuster dir -u http://10.10.10.48 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php -o 80</pre></div></p><p><img src="images/5-3.png" alt="images/5-3.png" /></p><p><h1>TCP/80</h1><a name="h1-3"></a></p><p>/admin</p><p><img src="images/5-4.png" alt="images/5-4.png" /></p><p>pi-hole是linux网络级别的广告和internet跟踪器阻止应用程序，可用作dns沉洞和可选的dhcp服务器，旨在用于专用网络。它专为具有网络功能的低功耗嵌入式设备（例如raspberry pi）而设计，但几乎可以安装在任何linux计算机上。</p><p>点击login会进入登录页面，仅需输入密码登录，输入默认密码raspberry不正确</p><p><h1>Shell as pi</h1><a name="h1-4"></a></p><p>使用pi-hole默认用户名密码，pi/raspberry可以成功连接ssh</p><p><img src="images/5-5.png" alt="images/5-5.png" /></p><p>然后寻找flag即可</p><p><h1>Shell as root</h1><a name="h1-5"></a></p><p>提权时使用sudo -l发现可以使用root权限执行所有命令，且不需要密码</p><p><img src="images/5-6.png" alt="images/5-6.png" /></p><p>那么直接切换至root用户即可！</p><p><img src="images/5-7.png" alt="images/5-7.png" /></p><p>但是在打开root.txt时，却显示该文件丢失，而且在USB闪存盘上有一个备份</p><p><img src="images/5-8.png" alt="images/5-8.png" /></p><p>使用mount命令显示所有已安装的驱动器</p><p><div class="codebox"><pre>/dev/sdb on /media/usbstick type ext4 (ro,nosuid,nodev,noexec,relatime,data=ordered)</pre></div></p><p>根据这一行信息可以知道原始设备为/dev/sdb，安装在/media/usbstick，可以看到该目录下有两个文件</p><p><img src="images/5-9.png" alt="images/5-9.png" /></p><p>前面的txt文件提示文件已经被删除，后面的目录也是空的</p><p><img src="images/5-10.png" alt="images/5-10.png" /></p><p>但是使用string该/dev/sdb可以看到root.txt</p><p><img src="images/5-11.png" alt="images/5-11.png" /></p></div>
</body>
</html>
