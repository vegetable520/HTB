<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Blocky</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Blocky</h1><br/><p><img src="images/4-1.png" alt="images/4-1.png" /></p><p><h3>对找到的jar文件进行反编译，会找到一组凭据，该凭据被重复利用于ssh，因此能够以notch身份登陆系统，而且notch可以以root用户执行任何命令，直接切换至root用户即可</h3></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>	◇ nmap</p><p>	◇ TCP/80</p><p>		▪ jadx反编译</p><p>		▪ phpmyadmin登录</p><p>	◇ Shell as Notch</p><p>	◇ Shell as root</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p><h1>nmap</h1><a name="h1-1"></a></p><p><div class="codebox"><pre>nmap -sC -sV -p- -oA nmap 10.10.10.37<br /><br />PORT      STATE  SERVICE   VERSION<br />21/tcp    open   ftp       ProFTPD 1.3.5a<br />22/tcp    open   ssh       OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA)<br />|   256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA)<br />|_  256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519)<br />80/tcp    open   http      Apache httpd 2.4.18<br />|_http-title: Did not follow redirect to http://blocky.htb<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />8192/tcp  closed sophos<br />25565/tcp open   minecraft Minecraft 1.11.2 (Protocol: 127, Message: A Minecraft Server, Users: 0/20)</pre></div></p><p><h1>TCP/80</h1><a name="h1-2"></a></p><p>看到80端口开启，先去看看网页相关信息，无法访问，提示302重定向到了http://blocky.htb</p><p><img src="images/4-2.png" alt="images/4-2.png" /></p><p>那就在/etc/hosts中添加对应的域名解析，添加情况如下</p><p><img src="images/4-3.png" alt="images/4-3.png" /></p><p>访问成功，可以看到目标网站使用的cms是wordpress</p><p><img src="images/4-4.png" alt="images/4-4.png" /></p><p>那么就使用wordpress进一步进行探索</p><p><div class="codebox"><pre>wpscan --url http://blocky.htb</pre></div></p><p>在此同时，浏览网站查看是否有什么有价值的信息，该博客网站只发了一条帖子，这个NOTCH很值得关注，说不定就是一个用户名</p><p><img src="images/4-5.png" alt="images/4-5.png" /></p><p>右下角有一个login，点击后跳转至一个登陆表单，输入veg/123456提示invalid username，输入notch/123456提示密码不正确，有理由相信notch为用户之一，可以采取用户名爆破，然后根据已有用户名进行暴力破解</p><p><img src="images/4-6.png" alt="images/4-6.png" /></p><p>先针对notch进行暴力破解，既然是wordpress，就用wpscan爆破试试</p><p><div class="codebox"><pre>wpscan --url http://blocky.htb -P /usr/share/wordlists/rockyou.txt</pre></div></p><p>可是爆破非常的慢，用gobuster扫描一下目录，看看有没有其他可以利用的</p><p><div class="codebox"><pre>gobuster dir -u http://blocky.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php -o gobuster</pre></div></p><p><img src="images/4-7.png" alt="images/4-7.png" /></p><p><h2>jadx反编译</h2><a name="h2-1"></a></p><p>在plugins中有两个jar文件，先下载下来，还发现了wordpress 的登录窗口，phpmyadmin的登录窗口，剩下的都没有什么，尝试查看两个jar文件，使用jadx工具对其进行反编译，发现了数据库的用户名和密码</p><p><img src="images/4-8.png" alt="images/4-8.png" /></p><p>得到了用户名和密码，尝试使用root/notch，以及密码8YsqfCTnvxAUeduzjNSXe22登录ftp，ssh，wordpress以及phpmyadmin的后台</p><p><h2>phpmyadmin登录</h2><a name="h2-2"></a></p><p>没办法登录到wordpress后台，但是可以使用root/8YsqfCTnvxAUeduzjNSXe22登录phpmyadmin后台，登陆成功后，重点关注wordpress内容</p><p><img src="images/4-9.png" alt="images/4-9.png" /></p><p>在wp_users中可以发现加密密码</p><p><img src="images/4-10.png" alt="images/4-10.png" /></p><p>在<a href="http://scriptserver.mainframe8.com/">http://scriptserver.mainframe8.com/</a>网站中，选择<a href="http://scriptserver.mainframe8.com/wordpress_password_hasher.php">Wordpress password hasher</a>生成一个密码，然后替换上图中的密码，点击edit编辑，修改成功后即可使用新密码登录wordpress</p><p><img src="images/4-11.png" alt="images/4-11.png" /></p><p>现在利用notch/vegetable即可登录wordpress后台，随便找个地方，然后写入webshell即可，后面就是一样的了</p><p><h1>Shell as Notch</h1><a name="h1-3"></a></p><p>经过尝试，使用notch/8YsqfCTnvxAUeduzjNSXe22成功通过ssh连接系统，但是我们目前的权限只是notch</p><p><img src="images/4-12.png" alt="images/4-12.png" /></p><p><h1>Shell as root</h1><a name="h1-4"></a></p><p>然后发现notch用户可以以root身份执行所有命令，那么直接切换至root用户即可</p><p><img src="images/4-13.png" alt="images/4-13.png" /></p></div>
</body>
</html>
